import{a as r,h as g,u as k,b as p}from"./index-DRGkhgkg.js";import{u as s,h as n,a as o}from"./sweet-alert-CQ0i_5mo.js";const S=async a=>{try{return(await r.post("https://backend-api-5m5k.onrender.com/api/auth/signup",a,{withCredentials:!0})).data}catch(t){throw t}},f=async a=>{try{return(await r.post("https://backend-api-5m5k.onrender.com/api/auth/signin",a,{withCredentials:!0})).data}catch(t){throw t}},q=async()=>(await r.post("https://backend-api-5m5k.onrender.com/api/auth/logout",{},{withCredentials:!0})).data,v=async a=>{try{return(await r.post("https://backend-api-5m5k.onrender.com/api/auth/forgot-password",a)).data}catch(t){throw t}},A=async a=>{try{return(await r.put(`https://backend-api-5m5k.onrender.com/api/auth/${a.id}`,{newpassword:a.newpassword})).data}catch(t){throw t}},b=async()=>{try{return(await r.get("https://backend-api-5m5k.onrender.com/api/auth")).data}catch(a){throw a}},F=async a=>{try{return(await r.delete(`https://backend-api-5m5k.onrender.com/api/auth/${a}`)).data}catch(t){throw t}},K=async()=>{try{return(await r.get("https://backend-api-5m5k.onrender.com/api/auth/data/admin")).data}catch(a){throw a}},L=()=>{const a=g(),t=k(),{data:h}=p({queryKey:["userauth"],queryFn:b}),{data:y}=p({queryKey:["adminAccount"],queryFn:K}),u=s({mutationFn:f,onSuccess:async e=>{await t.invalidateQueries({queryKey:["userauth"]}),await t.refetchQueries({queryKey:["userauth"]});const w=e.user.role;a(w==="staff"?"/page/staff":"/admin/dashboard")},onError:e=>{n(e.response.data.error)}}),l=s({mutationFn:S,onSuccess:()=>{o("Account Created"),t.invalidateQueries({queryKey:["userauth"]})},onError:e=>{n(e.response.data.error)}}),m=s({mutationFn:q,onSuccess:async()=>{await t.invalidateQueries({queryKey:["userauth"]}),await t.refetchQueries({queryKey:["userauth"]}),a("/",{replace:!0})},onError:e=>{n(e.response.data.error)}}),c=s({mutationFn:v,onSuccess:e=>{o(e.message),t.invalidateQueries({queryKey:["userauth"]})},onError:e=>{n(e.response.data.error)}}),i=s({mutationFn:A,onSuccess:e=>{o(e.message),t.invalidateQueries({queryKey:["userauth"]})},onError:e=>{n(e.response.data.error)}}),d=s({mutationFn:F,onSuccess:e=>{o(e.message),console.log(e.message),t.invalidateQueries({queryKey:["userauth"]})},onError:e=>{n(e.response.data.error)}});return{handleUserSignin:e=>{u.mutate(e)},signinMutation:u,handleUserSignup:e=>{l.mutate(e)},handleLogout:()=>{m.mutate()},handleForgotPassword:e=>{c.mutate(e)},forgotPasswordMutation:c,handleResetPassword:e=>{i.mutateAsync(e)},resetPasswordMutation:i,accountData:h,handleDelete:e=>{d.mutate(e)},deleteAccountMutation:d,adminAccountData:y}};export{L as a};
